{% extends 'base.html' %}
{%block content%}

  <div class="card my-3">

    <!-- 사용자 오류 표시 -->
    {% if messages %}
      <div class="alert alert-danger my-3" role="alert">
        {% for message in messages %}
          <strong>{{ message.tags }}</strong>
          <ul>
            <li>{{ message.message }}</li>
          </ul>
        {% endfor %}
      </div>
    {% endif %}

    <h2 class="boder-bottom py-2 text-primary">
      <i class="fa-solid fa-question"></i>
      {{ question.subject}}
    </h2>

    <div class="card-body">
      <div class="card-text" style="white-space: pre-line;">
        {{question.content}}</div>

      <!-- pre 태그는 공백문자 그대로 나오게 해줌 -->
      <div class="d-flex justify-content-end">
        <div class="badge badge-light p-2 text-left">
          <div class="mb-2">{{ question.author.username }}</div>
          <i class="fa-regular fa-clock"></i>
          <div>{{question.create_date}}</div>
        </div>
      </div>
    </div>
  </div>

  <h5 class="border-bottom my-3 py-2">
    <i class="fa-solid fa-comments"></i>
    {{question.answer_set.count}}개의 답변이 있습니다.
  </h5>

  {% for answer in question.answer_set.all %}
    <div class="card my-3">
      <div class="card-body">
        <div class="card-text" style="white-space: pre-line;">
          {{answer.content}}
        </div>
        <div class="d-flex justify-content-end">
          <div class="badge badge-light p-2">
            <i class="fa-regular fa-clock"></i>
            {{question.create_date}}
          </div>
        </div>
        {% if request.user == question.author %}
          <div class="my-3">
            <a href="#" class="btn btn-sm btn-outline-secondary">수정</a>
          </div>
        {% endif %}
      </div>
    </div>
    <!-- div.card-->
  {% endfor %}

  <form action=" {% url 'pybo:answer_create' question.id %} " method=" post" class="my-3">
    {% csrf_token %}
    <!-- 오류표시 start -->
    {% if form.errors %}
      <div class="alert alert-danger" role="alert">
        {% for field in form %}
          {% if field.errors %}
            <strong>{{ field.label }}</strong>
            {{field.errors}}
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
    <!-- 오류 표시 end-->

    <div class="form group">

      <textarea {% if not user.is_authenticated %} disabled="disabled" {% endif %} name="content" id="content" class="form-control" rows="10"></textarea>
      <!-- class="form-control" width 100% -->

    </div>
    <input type="submit" value="답변등록" class="btn btn-primary">
  </form>

  <a href="{% url 'pybo:index' %}">목록보기</a>
{% endblock content%}